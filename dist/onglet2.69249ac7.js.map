{"version":3,"sources":["scripts/onglet2.js"],"names":["ROW_CHART_HEIGHT","ROW_CHART_HEIGHT_MARGIN","d3","csv","then","data1","data2","data3","dataTypes","data","concat","dataVesselTypes","Map","dataVesselTypesArray","map","d","vesselClass","Class","vesselType","Type","entry","set","i","get","index","departureDate","timeParse","departurePort","arrivalDate","arrivalPort","vesselLength","vesselWidth","vesselCapacity","vesselDraught","chartWidth","chartHeight","chartNbBars","timeSelectWidth","ndx","crossfilter","vesselLengthRange","vesselLengthBarWidth","dimension","vesselLengths","group","Math","floor","vesselLengthChart","dc","BarChart","width","height","margins","top","right","bottom","left","x","scaleLinear","domain","xUnits","brushOn","xAxisLabel","elasticY","yAxis","ticks","render","vesselWidthRange","vesselWidthBarWidth","vesselWidths","vesselWidthChart","vesselCapacityRange","vesselCapacityBarWidth","vesselCapacities","vesselCapacityChart","vesselDraughtRange","vesselDraughtBarWidth","vesselDraughts","vesselDraughtChart","vesselTypeX","types","all","key","vesselTypeY","_","vesselTypesY","reduce","p","v","typeColorScale","scaleOrdinal","schemeSet2","firstType","vesselTypeChart","value","colors","legend","y","type","stack","length","filter","vesselTraffic","vesselTraffics","timeMonth","minDate","maxDate","vesselTrafficChart","round","scaleTime","rangeRound","portDim","includes","portTraffic","reduceCount","filteredGroup","remove_empty_bins","portChart","RowChart","xAxis","axisTop","othersGrouper","elasticX","label","fixedBarHeight","on","select","attr","selectAll","effectiveHeight","count","style","SingularStackedBarChart","parent","_groupAll","_colors","_width","_height","_duration","_root","registerChart","_rect","groupAll","arguments","svg","join","redraw","transition","duration","source_group"],"mappings":"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","file":"onglet2.69249ac7.js","sourceRoot":"..","sourcesContent":["const ROW_CHART_HEIGHT = 16.68\r\nconst ROW_CHART_HEIGHT_MARGIN = 21.75\r\n\r\n// Reading the data\r\nd3.csv(\"./TRIP_PART_1.csv\").then( function(data1) {\r\n    d3.csv(\"./TRIP_PART_2.csv\").then( function(data2) {\r\n        d3.csv(\"./TRIP_PART_3.csv\").then( function(data3) {\r\n            d3.csv(\"./Vessel Type Class.csv\").then(function(dataTypes) {\r\n                // Id,Departure Date,Departure Hardour,Departure Region,Departure Latitude,Departure Longitude,Arrival Date,Arrival Hardour,Arrival Region,Arrival Latitude,Arrival Longitude,Vessel Type,Lenght,Width,DeadWeight Tonnage,Maximum Draugth\r\n                // 6079000000783579,    2011-01-01 00:00:00.000,Virtual Harbour (Central Region),Central Region,45.71666667,-84.24861111,2011-01-01 15:30:00.000,Goderich,Central Region,43.745,-81.7294441666667,Merchant Bulk,222.509994506836,22.9400005340576,31751,8.72999954223633\r\n                // 23079000000766048,   2011-01-01 00:10:00.000,Whiffen Head,Newfoundland Region,47.7727836111111,-54.0171797222222,2011-01-01 01:00:00.000,Whiffen Head,Newfoundland Region,47.7727836111111,-54.0171797222222,Tug Fire,38.9000015258789,13.8999996185303,314,3.5\r\n                // 23079000000766035,   2011-01-01 00:57:00.000,Whiffen Head,Newfoundland Region,47.7727836111111,-54.0171797222222,2011-01-02 12:45:00.000,Virtual Harbour (Newfoundland Region),Newfoundland Region,47.75,-53,Merchant Crude,271.799987792969,46.0499992370606,126646,15.3459997177124\r\n    \r\n                let data = data1.concat(data2).concat(data3)\r\n\r\n                let dataVesselTypes = new Map()\r\n\r\n                const dataVesselTypesArray = dataTypes.map((d) => {\r\n                    return {\r\n                        vesselClass: d.Class,\r\n                        vesselType: d.Type\r\n                    }\r\n                })\r\n\r\n                for (const entry of dataVesselTypesArray) {\r\n                    const vesselClass = entry.vesselClass\r\n                    const vesselType = entry.vesselType\r\n                    dataVesselTypes.set(vesselType, vesselClass)\r\n                }\r\n                \r\n                data = data.map((d, i) => {\r\n                    const vesselType = d['Vessel Type']\r\n                    let vesselClass = dataVesselTypes.get(d['Vessel Type'])\r\n                    if (vesselType == '<Unknown Type>') {\r\n                        vesselClass = 'Other'\r\n                    }\r\n                    return {\r\n                        index: i,\r\n                        departureDate: d3.timeParse('%Y-%m-%d')(d['Departure Date']),\r\n                        departurePort: d['Departure Hardour'],\r\n                        arrivalDate: d3.timeParse('%Y-%m-%d')(d['Arrival Date']),\r\n                        arrivalPort: d['Arrival Hardour'],\r\n                        vesselClass: vesselClass,\r\n                        vesselType: d['Vessel Type'],\r\n                        vesselLength: +d['Lenght'],\r\n                        vesselWidth: +d['Width'],\r\n                        vesselCapacity: +d['DeadWeight Tonnage'],\r\n                        vesselDraught: +d['Maximum Draugth']\r\n                    }\r\n                })\r\n\r\n                const chartWidth = 776\r\n                const chartHeight = 160\r\n                const chartNbBars = 50\r\n\r\n                const timeSelectWidth = 950\r\n\r\n                const ndx = crossfilter(data)\r\n\r\n                const vesselLengthRange = 400\r\n                const vesselLengthBarWidth = vesselLengthRange / chartNbBars\r\n                const vesselLength = ndx.dimension(d => d.vesselLength)\r\n                const vesselLengths = vesselLength.group(d => Math.floor(d / vesselLengthBarWidth) * vesselLengthBarWidth)\r\n\r\n                const vesselLengthChart = new dc.BarChart('#length-chart')\r\n                .width(chartWidth)\r\n                .height(chartHeight)\r\n                .margins({top: 10, right: 50, bottom: 30, left: 50})\r\n                .x(d3.scaleLinear()\r\n                    .domain([0, vesselLengthRange]))\r\n                .xUnits(() => chartNbBars)\r\n                .brushOn(false)\r\n                .xAxisLabel('Longueur (m)')\r\n                .elasticY(true)\r\n                .dimension(vesselLength)\r\n                .group(vesselLengths)\r\n                \r\n                vesselLengthChart.yAxis().ticks(8)\r\n\r\n                vesselLengthChart.render()\r\n\r\n                const vesselWidthRange = 180\r\n                const vesselWidthBarWidth = vesselWidthRange / chartNbBars\r\n                const vesselWidth = ndx.dimension(d => d.vesselWidth)\r\n                const vesselWidths = vesselWidth.group(d => Math.floor(d / vesselWidthBarWidth) * vesselWidthBarWidth)\r\n\r\n                const vesselWidthChart = new dc.BarChart('#width-chart')\r\n                .width(chartWidth)\r\n                .height(chartHeight)\r\n                .margins({top: 10, right: 50, bottom: 30, left: 50})\r\n                .x(d3.scaleLinear()\r\n                    .domain([0, vesselWidthRange]))\r\n                .xUnits(() => chartNbBars)\r\n                .brushOn(false)\r\n                .xAxisLabel('Largeur (m)')\r\n                .elasticY(true)\r\n                .dimension(vesselWidth)\r\n                .group(vesselWidths)\r\n\r\n                vesselWidthChart.yAxis().ticks(7)\r\n\r\n                vesselWidthChart.render()\r\n\r\n                const vesselCapacityRange = 650000\r\n                const vesselCapacityBarWidth = vesselCapacityRange / chartNbBars\r\n                const vesselCapacity = ndx.dimension(d => d.vesselCapacity)\r\n                const vesselCapacities = vesselCapacity.group(d => Math.floor(d / vesselCapacityBarWidth) * vesselCapacityBarWidth)\r\n\r\n                const vesselCapacityChart = new dc.BarChart('#capacity-chart')\r\n                .width(chartWidth)\r\n                .height(chartHeight)\r\n                .margins({top: 10, right: 50, bottom: 30, left: 50})\r\n                .x(d3.scaleLinear()\r\n                    .domain([0, vesselCapacityRange]))\r\n                .xUnits(() => chartNbBars)\r\n                .brushOn(false)\r\n                .xAxisLabel('Capacité (t)')\r\n                .elasticY(true)\r\n                .dimension(vesselCapacity)\r\n                .group(vesselCapacities)\r\n                \r\n                vesselCapacityChart.yAxis().ticks(9)\r\n\r\n                vesselCapacityChart.render()\r\n\r\n                const vesselDraughtRange = 30\r\n                const vesselDraughtBarWidth = vesselDraughtRange / chartNbBars\r\n                const vesselDraught = ndx.dimension(d => d.vesselDraught)\r\n                const vesselDraughts = vesselDraught.group(d => Math.floor(d / vesselDraughtBarWidth) * vesselDraughtBarWidth)\r\n\r\n                const vesselDraughtChart = new dc.BarChart('#draught-chart')\r\n                .width(chartWidth)\r\n                .height(chartHeight)\r\n                .margins({top: 10, right: 50, bottom: 30, left: 50})\r\n                .x(d3.scaleLinear()\r\n                    .domain([0, vesselDraughtRange]))\r\n                .xUnits(() => chartNbBars)\r\n                .brushOn(false)\r\n                .xAxisLabel(\"Tirant d'eau (m)\")\r\n                .elasticY(true)\r\n                .dimension(vesselDraught)\r\n                .group(vesselDraughts)\r\n                \r\n                vesselDraughtChart.yAxis().ticks(6)\r\n\r\n                vesselDraughtChart.render()\r\n\r\n                \r\n                const vesselTypeX = ndx.dimension(d => d.vesselClass)\r\n                const types = vesselTypeX.group().all().map(d => d.key)\r\n\r\n                const vesselTypeY = ndx.dimension(_ => 0)\r\n                const vesselTypesY = vesselTypeY.group().reduce(\r\n                    function(p, v) {\r\n                      p[v.vesselClass] = (p[v.vesselClass] || 0) + 1;\r\n                      return p;}, \r\n                    function(p, v) {\r\n                      p[v.vesselClass] = (p[v.vesselClass] || 0) - 1;\r\n                      return p;}, \r\n                    function() {\r\n                      return {};\r\n                    })\r\n\r\n                const typeColorScale = d3.scaleOrdinal(d3.schemeSet2).domain(types)\r\n\r\n                const firstType = types[0]\r\n\r\n                const vesselTypeChart = new dc.BarChart(\"#type-chart\")\r\n                .x(d3.scaleOrdinal().domain([0, 0]))\r\n                .width(200)\r\n                .height(750)\r\n                .margins({top: 10, right: 50, bottom: 180, left: 0})\r\n                .dimension(vesselTypeY)\r\n                .group(vesselTypesY, firstType, d => d.value[firstType])\r\n                .xUnits(() => 1)\r\n                .colors(typeColorScale)\r\n                .brushOn(false)\r\n                .elasticY(true)\r\n                .legend(dc.legend().y(600))\r\n                \r\n\r\n                for (let i = 1; i < types.length; i++) {\r\n                    const type = types[i]\r\n                    vesselTypeChart.stack(vesselTypesY, type, d => d.value[type])\r\n                }\r\n\r\n                vesselTypeChart.filter = function() {};\r\n\r\n                vesselTypeChart.render()\r\n\r\n                const vesselTraffic = ndx.dimension(d => d.departureDate)\r\n                const vesselTraffics = vesselTraffic.group(d3.timeMonth)\r\n                \r\n                const minDate = vesselTraffic.bottom(1)[0].departureDate\r\n                const maxDate = vesselTraffic.top(1)[0].departureDate\r\n\r\n                // const vesselTrafficRange = maxDate - minDate\r\n                // const vesselTrafficBarWidth = vesselTrafficRange / chartNbBars\r\n\r\n                const vesselTrafficChart = new dc.BarChart('#tab-2-content .traffic-chart')\r\n                .width(timeSelectWidth)\r\n                .height(125)\r\n                .margins({top: 10, right: 50, bottom: 30, left: 30})\r\n                .dimension(vesselTraffic)\r\n                .group(vesselTraffics)\r\n                .round(d3.timeMonth)\r\n                .x(d3.scaleTime()\r\n                    .domain([minDate, maxDate])\r\n                    .rangeRound([0, timeSelectWidth]))\r\n                .brushOn(true)\r\n                .elasticY(true)\r\n\r\n                vesselTrafficChart.yAxis().ticks(5)\r\n\r\n                vesselTrafficChart.render()\r\n\r\n                const portDim = ndx.dimension(d => d.departurePort)\r\n\r\n                ndx.dimension(d=> d.departurePort)\r\n                    .filter(d => !d.includes('Virtual harbour'))\r\n\r\n                const portTraffic = portDim.group().reduceCount()\r\n                const filteredGroup = remove_empty_bins(portTraffic)\r\n\r\n                const portChart = new dc.RowChart('#port-chart')\r\n                .width(600)\r\n                .height(900)\r\n                .margins({top: 30, right: 50, bottom: 30, left: 30})\r\n                .dimension(portDim)\r\n                .group(filteredGroup)\r\n                .x(d3.scaleLinear()\r\n                    .domain([0, portTraffic.top(1)[0].value])\r\n                    .rangeRound([0, 500]))\r\n                .xAxis(d3.axisTop())\r\n                .colors(d3.scaleOrdinal(['#1f77b4']))\r\n                .othersGrouper(false)\r\n                .elasticX(true)\r\n                .label(d => d.key + ': ' + d.value)\r\n                .fixedBarHeight(ROW_CHART_HEIGHT)\r\n\r\n                portChart.on('pretransition', function() {\r\n                    portChart.select('g.axis').attr('transform', 'translate(0,0)')\r\n                    portChart.selectAll('line.grid-line').attr('y2', portChart.effectiveHeight())\r\n                    const count = filteredGroup.all().length\r\n                    const height = count * ROW_CHART_HEIGHT_MARGIN + 20\r\n                    portChart.select('svg').attr('height', height)\r\n                })\r\n\r\n                portChart.render()\r\n\r\n                d3.select(\"#loader\")\r\n                    .style(\"display\", \"none\")\r\n                d3.select(\"#loader-container\")\r\n                    .style(\"display\", \"none\")\r\n            })\r\n        })\r\n    })\r\n})\r\n\r\nclass SingularStackedBarChart {\r\n    constructor(parent, group) {\r\n        this._groupAll = null;\r\n        this._colors = null;\r\n        this._width = this._height = 200;\r\n        this._duration = 500;\r\n        this._root = d3.select(parent);\r\n        dc.registerChart(this, group);\r\n        this._rect = null;\r\n    }\r\n\r\n    groupAll(groupAll) {\r\n        if(!arguments.length)\r\n            return this._groupAll;\r\n        this._groupAll = groupAll;\r\n        return this;\r\n    }\r\n\r\n    colors(colors) {\r\n        if(!arguments.length)\r\n            return this._colors;\r\n        this._colors = colors;\r\n        return this;\r\n    }\r\n\r\n    render() {\r\n        const width = 200, height = 200;\r\n        let svg = this._root.selectAll('svg')\r\n            .data([0])\r\n            .join('svg')\r\n            .attr('width', width)\r\n            .attr('height', width);\r\n        this._rect = svg.selectAll('rect.swatch')\r\n            .data([0])\r\n            .join('rect')\r\n            .attr('class', 'swatch')\r\n            .attr('width', width)\r\n            .attr('height', width);\r\n        this.redraw();\r\n    }\r\n\r\n    redraw() {\r\n        this._rect.transition()\r\n            .duration(this._duration)\r\n            .attr('fill', this._colors(this._groupAll.value()));\r\n    }\r\n}\r\n\r\n// https://github.com/dc-js/dc.js/wiki/FAQ#how-do-i-filter-the-data-before-its-charted\r\nfunction remove_empty_bins(source_group) {\r\n    return {\r\n        all:function () {\r\n            return source_group.all().filter(function(d) {\r\n                return d.value !== 0;\r\n            });\r\n        }\r\n    };\r\n}"]}